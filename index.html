<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>HeistCasino</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
}

body {
    font-family: 'Arial', sans-serif;
    background: #0f0f0f;
    color: white;
    min-height: 100vh;
    padding: 20px;
    user-select: none;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    -webkit-touch-callout: none;
    overflow: hidden;
    padding-bottom: 80px;
    touch-action: manipulation;
}
body, body * {
    -webkit-user-select: none !important;
    -moz-user-select: none !important;
    -ms-user-select: none !important;
    user-select: none !important;
    -webkit-touch-callout: none !important;
    -webkit-user-drag: none !important;
}

.container {
    max-width: 400px;
    margin: 0 auto;
    display: flex;
    flex-direction: column;
    height: calc(100vh - 120px);
}

.content-container {
    flex: 1;
    overflow: hidden;
    position: relative;
}

.page {
    display: none;
}

.page.active {
    display: block;
}

.profile-card {
    background: rgba(139, 92, 246, 0.1);
    border: 2px solid #8B5CF6;
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 15px;
}

.action-buttons {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    width: 100%;
    max-width: 400px;
    margin-bottom: 15px;
}

.profile-section {
    text-align: center;
    margin-bottom: 15px;
}

.avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: linear-gradient(135deg, #8B5CF6, #7C3AED);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    font-weight: bold;
    margin: 0 auto 15px auto;
    border: 3px solid #8B5CF6;
    overflow: hidden;
}

.avatar-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    pointer-events: none;
}

.username {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 5px;
}

.balance-section {
    text-align: center;
}

.balance-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-bottom: 5px;
}

.balance-amount {
    font-size: 32px;
    font-weight: bold;
}

.crypto-icon {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}

.crypto-icon img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    pointer-events: none;
}

.action-btn {
    background: #8B5CF6;
    border: none;
    border-radius: 12px;
    padding: 15px;
    color: white;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    -webkit-tap-highlight-color: transparent;
    outline: none;
}

.action-btn:active {
    background: #6D28D9;
    transform: translateY(0);
}

.inventory-section {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: rgba(139, 92, 246, 0.1);
    border: 2px solid #8B5CF6;
    border-radius: 20px;
    padding: 20px;
    overflow: hidden;
    max-height: 350px;
}

.inventory-title {
    text-align: center;
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 15px;
}

.inventory-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    overflow-y: auto;
    padding-right: 5px;
    flex: 1;
    padding-bottom: 20px;
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.inventory-grid::-webkit-scrollbar {
    display: none;
    width: 0;
}

.inventory-item {
    background: rgba(139, 92, 246, 0.2);
    border: 1px solid #8B5CF6;
    border-radius: 12px;
    padding: 15px;
    text-align: center;
}

.inventory-image {
    width: 60px;
    height: 60px;
    border-radius: 10px;
    background: linear-gradient(135deg, #8B5CF6, #7C3AED);
    margin: 0 auto 8px;
    overflow: hidden;
    display: flex;
    align-items: center;
    justify-content: center;
}

.inventory-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.inventory-name {
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 4px;
}

.inventory-value {
    font-size: 11px;
    color: #8B5CF6;
}

.cases-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding: 0 10px;
}

.user-avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: linear-gradient(135deg, #8B5CF6, #7C3AED);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
    font-weight: bold;
    border: 2px solid #8B5CF6;
    overflow: hidden;
}

.user-avatar-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.balance-badge {
    background: rgba(139, 92, 246, 0.2);
    border: 2px solid #8B5CF6;
    border-radius: 20px;
    padding: 8px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-weight: bold;
}

.balance-icon {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: #26A17B;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    color: white;
}

.section-title {
    text-align: center;
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
}

.cases-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 15px;
    margin-bottom: 20px;
    justify-items: center;
}

.case-item {
    background: transparent;
    border: none;
    border-radius: 15px;
    padding: 0;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    max-width: 170px;
}

.case-item:active {
    transform: scale(0.95);
}

.case-image {
    width: 100%;
    height: 140px;
    border-radius: 15px;
    margin-bottom: 8px;
    overflow: hidden;
}

.case-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.case-price {
    text-align: center;
    font-size: 14px;
    font-weight: bold;
    color: #8B5CF6;
}

.error-message {
    color: #EF4444;
    font-size: 12px;
    text-align: center;
    margin-top: 5px;
    height: 15px;
}

.free-case-timer {
    font-size: 12px;
    color: #94A3B8;
    margin-top: 5px;
    text-align: center;
    height: 15px;
}

.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.95);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 2000;
    padding: 20px;
}

.case-opening-container {
    width: 100%;
    max-width: 400px;
    text-align: center;
    position: relative;
}

.close-case-btn {
    position: absolute;
    top: -40px;
    right: 0;
    background: none;
    border: none;
    color: white;
    font-size: 24px;
    cursor: pointer;
    z-index: 10;
}

.case-prize-wheel {
    position: relative;
    height: 250px;
    margin: 30px 0;
    overflow: hidden;
    border-radius: 15px;
    display: flex;
    justify-content: center;
}

.prize-items {
    display: flex;
    transition: transform 0.1s linear;
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    top: 0;
}

.prize-item {
    min-width: 120px;
    height: 180px;
    margin: 0 8px;
    background: rgba(139, 92, 246, 0.2);
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 10px;
}

.prize-image {
    width: 80px;
    height: 80px;
    border-radius: 10px;
    margin-bottom: 8px;
    overflow: hidden;
}

.prize-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.prize-name {
    font-size: 12px;
    font-weight: bold;
    margin-bottom: 4px;
}

.prize-value {
    font-size: 11px;
    color: #8B5CF6;
}

.pointer {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 20px solid #8B5CF6;
    z-index: 10;
}

.open-case-btn {
    background: #8B5CF6;
    border: none;
    border-radius: 12px;
    padding: 15px 30px;
    color: white;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    margin-top: 20px;
    width: 100%;
}

.open-case-btn:active {
    background: #6D28D9;
}

.open-case-btn:disabled {
    background: #94A3B8;
    cursor: not-allowed;
}

.result-modal {
    background: #1a1a1a;
    border-radius: 20px;
    padding: 30px;
    text-align: center;
    max-width: 300px;
}

.result-title {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 20px;
    color: #8B5CF6;
}

.result-prize {
    background: rgba(139, 92, 246, 0.2);
    border-radius: 15px;
    padding: 20px;
    margin-bottom: 20px;
}

.result-image {
    width: 80px;
    height: 80px;
    border-radius: 12px;
    margin: 0 auto 15px;
    overflow: hidden;
}

.result-image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.result-name {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 5px;
}

.result-value {
    font-size: 16px;
    color: #8B5CF6;
}

.close-result-btn {
    background: #8B5CF6;
    border: none;
    border-radius: 12px;
    padding: 12px 24px;
    color: white;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
}

.bottom-menu {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: rgba(15, 15, 15, 0.95);
    backdrop-filter: blur(10px);
    border-top: 1px solid #8B5CF6;
    padding: 10px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    z-index: 1000;
}

.menu-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
    padding: 8px 5px;
    cursor: pointer;
    transition: all 0.3s ease;
    border-radius: 10px;
    min-height: 50px;
    -webkit-tap-highlight-color: transparent;
}

.menu-item.active {
    background: rgba(139, 92, 246, 0.2);
}

.menu-icon {
    width: 24px;
    height: 24px;
    margin-bottom: 4px;
}

.menu-icon img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.menu-text {
    font-size: 12px;
    font-weight: 500;
    color: #94A3B8;
}

.menu-item.active .menu-text {
    color: #8B5CF6;
}

.placeholder-page {
    text-align: center;
    padding: 50px 20px;
    color: #94A3B8;
}

.placeholder-icon {
    font-size: 48px;
    margin-bottom: 20px;
}

.placeholder-title {
    font-size: 20px;
    font-weight: bold;
    margin-bottom: 10px;
}

@media (max-width: 480px) {
    .container {
        height: calc(100vh - 100px);
    }
    .profile-card {
        padding: 15px;
        margin-bottom: 10px;
    }
    .action-buttons {
        gap: 8px;
        margin-bottom: 10px;
    }
    .action-btn {
        padding: 14px;
    }
    .inventory-section {
        padding: 15px;
        max-height: 300px;
    }
    .cases-grid {
        gap: 12px;
    }
    .case-image {
        height: 120px;
    }
    .case-item {
        max-width: 150px;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <div class="content-container">
            <div class="page active" id="profilePage">
                <div class="profile-card">
                    <div class="profile-section">
                        <div class="avatar" id="userAvatar"></div>
                        <div class="username" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</div>
                    </div>
                    <div class="balance-section">
                        <div class="balance-container">
                            <div class="crypto-icon">
                                <img src="https://s3.iimg.su/s/19/ggtBKLOxrTWMssj4hn6hUA4BI3ahC9pQ7FekzHzO.jpg" alt="Crypto" />
                            </div>
                            <div class="balance-amount" id="userBalance">0.00</div>
                        </div>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="action-btn" onclick="showDepositModal()">–ü–æ–ø–æ–ª–Ω–∏—Ç—å</button>
                    <button class="action-btn" onclick="openBotForWithdraw()">–í—ã–≤–µ—Å—Ç–∏</button>
                </div>

                <div class="inventory-section">
                    <div class="inventory-title">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
                    <div class="inventory-grid" id="inventoryGrid">
                        <!-- –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <div class="page" id="casesPage">
                <div class="cases-header">
                    <div class="user-avatar" id="casesUserAvatar"></div>
                    <div class="balance-badge">
                        <div class="crypto-icon">
                            <img src="https://s3.iimg.su/s/19/ggtBKLOxrTWMssj4hn6hUA4BI3ahC9pQ7FekzHzO.jpg" alt="Crypto" />
                        </div>
                        <span id="casesUserBalance">0.00</span>
                    </div>
                </div>

                <div class="section-title">üéÅ –ö–µ–π—Å—ã</div>

                <div class="cases-grid">
                    <div class="case-item free-case-item" onclick="openFreeCase()">
                        <div class="case-image">
                            <img src="https://via.placeholder.com/300x200/10B981/FFFFFF?text=FREE" alt="–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–µ–π—Å" />
                        </div>
                        <div class="case-price">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</div>
                        <div class="free-case-timer" id="freeCaseTimer">–î–æ—Å—Ç—É–ø–Ω–æ</div>
                    </div>

                    <div class="case-item">
                        <div class="case-image" onclick="openCase('case1')">
                            <img src="https://via.placeholder.com/300x200/8B5CF6/FFFFFF?text=2000%24" alt="–ö–µ–π—Å 2000$" />
                        </div>
                        <div class="case-price">2000$</div>
                        <div class="error-message" id="errorCase1"></div>
                    </div>

                    <div class="case-item">
                        <div class="case-image" onclick="openCase('case2')">
                            <img src="https://via.placeholder.com/300x200/7C3AED/FFFFFF?text=5000%24" alt="–ö–µ–π—Å 5000$" />
                        </div>
                        <div class="case-price">5000$</div>
                        <div class="error-message" id="errorCase2"></div>
                    </div>

                    <div class="case-item">
                        <div class="case-image" onclick="openCase('case3')">
                            <img src="https://via.placeholder.com/300x200/6D28D9/FFFFFF?text=15000%24" alt="–ö–µ–π—Å 15000$" />
                        </div>
                        <div class="case-price">15000$</div>
                        <div class="error-message" id="errorCase3"></div>
                    </div>
                </div>
            </div>

            <div class="page" id="tasksPage">
                <div class="placeholder-page">
                    <div class="placeholder-icon">üìã</div>
                    <div class="placeholder-title">–ó–∞–¥–∞–Ω–∏—è</div>
                    <div>–°–∫–æ—Ä–æ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã</div>
                </div>
            </div>

            <div class="page" id="shopPage">
                <div class="placeholder-page">
                    <div class="placeholder-icon">üõí</div>
                    <div class="placeholder-title">–ú–∞–≥–∞–∑–∏–Ω</div>
                    <div>–°–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–µ–π—Å–∞ -->
    <div class="modal-overlay" id="caseModal">
        <div class="case-opening-container">
            <button class="close-case-btn" onclick="closeCaseModal()">‚úï</button>
            <div class="section-title" id="caseModalTitle">–û—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞</div>
            
            <div class="case-prize-wheel">
                <div class="pointer"></div>
                <div class="prize-items" id="prizeItems"></div>
            </div>
            
            <button class="open-case-btn" id="spinBtn" onclick="spinWheel()">–û—Ç–∫—Ä—ã—Ç—å –∫–µ–π—Å</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ -->
    <div class="modal-overlay" id="resultModal">
        <div class="result-modal">
            <div class="result-title">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
            <div class="result-prize" id="resultPrize">
                <!-- –ü—Ä–∏–∑ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å -->
            </div>
            <button class="close-result-btn" onclick="closeResult()">–ó–∞–±—Ä–∞—Ç—å</button>
        </div>
    </div>

    <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
    <div class="bottom-menu">
        <div class="menu-item active" onclick="navigateTo('profile')">
            <div class="menu-icon">
                <img src="https://s3.iimg.su/s/19/gju6MLbx7lZF5quIOdqoHS6j8p6N8Bjz5vTdqO95.png" alt="–ú–µ–Ω—é" />
            </div>
            <div class="menu-text">–ú–µ–Ω—é</div>
        </div>
        <div class="menu-item" onclick="navigateTo('cases')">
            <div class="menu-icon">
                <img src="https://s3.iimg.su/s/19/gNb1bl3xdteUVp1hup5BiVZVNdSrnzbeVzlFzPRN.png" alt="Cases" />
            </div>
            <div class="menu-text">Cases</div>
        </div>
        <div class="menu-item" onclick="navigateTo('tasks')">
            <div class="menu-icon">
                <img src="https://s3.iimg.su/s/19/gXJoiOnxdWrhXXnzzw3M0dWAZtDRjpijYZqT4eYb.png" alt="–ó–∞–¥–∞–Ω–∏—è" />
            </div>
            <div class="menu-text">–ó–∞–¥–∞–Ω–∏—è</div>
        </div>
        <div class="menu-item" onclick="navigateTo('shop')">
            <div class="menu-icon">
                <img src="https://s3.iimg.su/s/19/gaBpORBx6t8NVDpTMuZjZKbq7ZNKj9Jhsg9Fgv7S.png" alt="–ü—Ä–æ—Ñ–∏–ª—å" />
            </div>
            <div class="menu-text">–ú–∞–≥–∞–∑–∏–Ω</div>
        </div>
    </div>

    <script>
        const CASES_CONFIG = {
            free: {
                name: "–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–µ–π—Å",
                price: 0,
                prizes: [
                    { name: "iPhone 15", value: 1000, image: "https://via.placeholder.com/100/8B5CF6/FFFFFF?text=IP15" },
                    { name: "MacBook Pro", value: 2500, image: "https://via.placeholder.com/100/7C3AED/FFFFFF?text=MBP" },
                    { name: "PlayStation 5", value: 500, image: "https://via.placeholder.com/100/6D28D9/FFFFFF?text=PS5" },
                    { name: "AirPods Pro", value: 250, image: "https://via.placeholder.com/100/5B21B6/FFFFFF?text=APP" }
                ]
            },
            case1: {
                name: "–ö–µ–π—Å 2000$",
                price: 2000,
                prizes: [
                    { name: "iPhone 15 Pro", value: 1500, image: "https://via.placeholder.com/100/8B5CF6/FFFFFF?text=IP15P" },
                    { name: "iPad Air", value: 800, image: "https://via.placeholder.com/100/7C3AED/FFFFFF?text=IPA" },
                    { name: "Apple Watch", value: 400, image: "https://via.placeholder.com/100/6D28D9/FFFFFF?text=AW" },
                    { name: "AirPods Max", value: 550, image: "https://via.placeholder.com/100/5B21B6/FFFFFF?text=APM" }
                ]
            },
            case2: {
                name: "–ö–µ–π—Å 5000$",
                price: 5000,
                prizes: [
                    { name: "MacBook Pro M3", value: 3000, image: "https://via.placeholder.com/100/8B5CF6/FFFFFF?text=MBP3" },
                    { name: "iPhone 15 Pro Max", value: 1200, image: "https://via.placeholder.com/100/7C3AED/FFFFFF?text=IP15M" },
                    { name: "iPad Pro", value: 1000, image: "https://via.placeholder.com/100/6D28D9/FFFFFF?text=IPP" },
                    { name: "Vision Pro", value: 3500, image: "https://via.placeholder.com/100/5B21B6/FFFFFF?text=VP" }
                ]
            },
            case3: {
                name: "–ö–µ–π—Å 15000$",
                price: 15000,
                prizes: [
                    { name: "Tesla Model 3", value: 40000, image: "https://via.placeholder.com/100/8B5CF6/FFFFFF?text=TESLA" },
                    { name: "Rolex Watch", value: 10000, image: "https://via.placeholder.com/100/7C3AED/FFFFFF?text=ROLEX" },
                    { name: "Mac Pro", value: 6000, image: "https://via.placeholder.com/100/6D28D9/FFFFFF?text=MP" },
                    { name: "Gold Bar", value: 2000, image: "https://via.placeholder.com/100/5B21B6/FFFFFF?text=GOLD" }
                ]
            }
        };

        let currentCase = null;
        let freeCaseAvailable = true;
        let freeCaseCooldown = 24 * 60 * 60 * 1000;
        let userBalance = 0;
        let userInventory = [];

        function openCase(caseType) {
            const caseConfig = CASES_CONFIG[caseType];
            const errorElement = document.getElementById('error' + caseType.charAt(0).toUpperCase() + caseType.slice(1));
            
            if (userBalance < caseConfig.price) {
                errorElement.textContent = "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤";
                setTimeout(() => {
                    errorElement.textContent = "";
                }, 3000);
                return;
            }
            
            userBalance -= caseConfig.price;
            updateBalanceDisplay();
            saveUserData();
            
            currentCase = caseConfig;
            showCaseModal();
        }

        function spinWheel() {
            const spinBtn = document.getElementById('spinBtn');
            spinBtn.disabled = true;
            spinBtn.textContent = "–ö—Ä—É—Ç–∏—Ç—Å—è...";
            
            const prizeItems = document.getElementById('prizeItems');
            const itemsCount = currentCase.prizes.length;

            const random = Math.random();
            let accumulatedChance = 0;
            let selectedPrize = null;
            
            for (const prize of currentCase.prizes) {
                accumulatedChance += 1 / itemsCount;
                if (random <= accumulatedChance) {
                    selectedPrize = prize;
                    break;
                }
            }

            // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –¥–æ 7 —Å–µ–∫—É–Ω–¥
            const totalDuration = 7000;
            const fastDuration = 4000; // –ë—ã—Å—Ç—Ä–∞—è —Ñ–∞–∑–∞ 4 —Å–µ–∫—É–Ω–¥—ã
            const slowDuration = 3000; // –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ñ–∞–∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã
            
            const startTime = Date.now();
            const startPosition = 0;
            const targetPosition = -(itemsCount * 128 * 8 + Math.random() * 128);
            
            let animationId;

            function animate() {
                const currentTime = Date.now();
                const elapsed = currentTime - startTime;
                
                let progress;
                if (elapsed < fastDuration) {
                    progress = elapsed / fastDuration;
                    prizeItems.style.transition = 'transform 0.01s linear';
                } else {
                    progress = (elapsed - fastDuration) / slowDuration;
                    prizeItems.style.transition = 'transform 0.08s ease-out';
                }
                
                const totalProgress = elapsed / totalDuration;
                
                if (totalProgress < 1) {
                    const currentPosition = startPosition + (targetPosition - startPosition) * totalProgress;
                    prizeItems.style.transform = `translateX(${currentPosition}px)`;
                    animationId = requestAnimationFrame(animate);
                } else {
                    setTimeout(() => showResult(selectedPrize), 500);
                }
            }
            
            animate();
        }

        function openFreeCase() {
            if (!freeCaseAvailable) {
                return;
            }
            
            currentCase = CASES_CONFIG.free;
            showCaseModal();
            freeCaseAvailable = false;
            localStorage.setItem('lastFreeCase', Date.now().toString());
            updateFreeCaseButton();
            startFreeCaseTimer(freeCaseCooldown);
        }

        function updateFreeCaseButton() {
            const timerElement = document.getElementById('freeCaseTimer');
            
            if (freeCaseAvailable) {
                timerElement.textContent = "–î–æ—Å—Ç—É–ø–Ω–æ —Å–µ–π—á–∞—Å!";
                timerElement.style.color = "#10B981";
            } else {
                timerElement.textContent = "–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ";
                timerElement.style.color = "#94A3B8";
            }
        }

        function startFreeCaseTimer(remainingTime) {
            const timerElement = document.getElementById('freeCaseTimer');
            const interval = setInterval(() => {
                remainingTime -= 1000;
                
                if (remainingTime <= 0) {
                    clearInterval(interval);
                    freeCaseAvailable = true;
                    updateFreeCaseButton();
                    timerElement.textContent = "–î–æ—Å—Ç—É–ø–Ω–æ —Å–µ–π—á–∞—Å!";
                    timerElement.style.color = "#10B981";
                    return;
                }
                
                const hours = Math.floor(remainingTime / (1000 * 60 * 60));
                const minutes = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((remainingTime % (1000 * 60)) / 1000);
                
                timerElement.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                timerElement.style.color = "#94A3B8";
            }, 1000);
        }

        function navigateTo(page) {
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            event.currentTarget.classList.add('active');
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            const targetPage = document.getElementById(page + 'Page');
            if (targetPage) {
                targetPage.classList.add('active');
                if (page === 'cases') {
                    updateCasesBalance();
                }
            }
        }

        function initTelegramApp() {
            try {
                const tg = window.Telegram.WebApp;
                tg.expand();

                const user = tg.initDataUnsafe.user;
                if (user) {
                    const avatarElements = document.querySelectorAll('#userAvatar, #casesUserAvatar');
                    avatarElements.forEach(avatarElement => {
                        if (user.photo_url) {
                            avatarElement.innerHTML = `<img src="${user.photo_url}" alt="Avatar" class="avatar-img">`;
                        } else {
                            const initial = user.first_name ? user.first_name.charAt(0).toUpperCase() : 'U';
                            avatarElement.textContent = initial;
                        }
                    });

                    let displayName = user.first_name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
                    if (user.last_name) {
                        displayName += ' ' + user.last_name;
                    }
                    document.getElementById('userName').textContent = displayName;
                }

                loadUserData();
                loadFreeCaseState();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            }
        }

        function loadUserData() {
            const savedBalance = localStorage.getItem('userBalance');
            const savedInventory = localStorage.getItem('userInventory');
            
            if (savedBalance) {
                userBalance = parseFloat(savedBalance);
                updateBalanceDisplay();
            }
            
            if (savedInventory) {
                userInventory = JSON.parse(savedInventory);
                updateInventoryDisplay();
            }
        }

        function saveUserData() {
            localStorage.setItem('userBalance', userBalance.toString());
            localStorage.setItem('userInventory', JSON.stringify(userInventory));
        }

        function updateBalanceDisplay() {
            document.getElementById('userBalance').textContent = userBalance.toFixed(2);
            document.getElementById('casesUserBalance').textContent = userBalance.toFixed(2);
        }

        function updateInventoryDisplay() {
            const inventoryGrid = document.getElementById('inventoryGrid');
            inventoryGrid.innerHTML = '';
            
            userInventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.innerHTML = `
                    <div class="inventory-image">
                        <img src="${item.image}" alt="${item.name}" />
                    </div>
                    <div class="inventory-name">${item.name}</div>
                    <div class="inventory-value">${item.value}$</div>
                `;
                inventoryGrid.appendChild(itemElement);
            });
        }

        function addToInventory(prize) {
            userInventory.push(prize);
            updateInventoryDisplay();
            saveUserData();
        }

        function loadFreeCaseState() {
            const lastFreeCase = localStorage.getItem('lastFreeCase');
            if (lastFreeCase) {
                const timePassed = Date.now() - parseInt(lastFreeCase);
                if (timePassed < freeCaseCooldown) {
                    freeCaseAvailable = false;
                    startFreeCaseTimer(freeCaseCooldown - timePassed);
                }
            }
            updateFreeCaseButton();
        }

        function showCaseModal() {
            document.getElementById('caseModal').style.display = 'flex';
            initializePrizeWheel();
        }

        function closeCaseModal() {
            document.getElementById('caseModal').style.display = 'none';
        }
function initializePrizeWheel() {
    const prizeItems = document.getElementById('prizeItems');
    prizeItems.innerHTML = '';

    for (let i = 0; i < 10; i++) {
        currentCase.prizes.forEach(prize => {
            const prizeElement = document.createElement('div');
            prizeElement.className = 'prize-item';
            prizeElement.innerHTML = `
                <div class="prize-image">
                    <img src="${prize.image}" alt="${prize.name}" />
                </div>
                <div class="prize-name">${prize.name}</div>
                <div class="prize-value">${prize.value}$</div>
            `;
            prizeItems.appendChild(prizeElement);
        });
    }
}

        function showResult(prize) {
            document.getElementById('caseModal').style.display = 'none';
            
            const resultPrize = document.getElementById('resultPrize');
            resultPrize.innerHTML = `
                <div class="result-image">
                    <img src="${prize.image}" alt="${prize.name}" />
                </div>
                <div class="result-name">${prize.name}</div>
                <div class="result-value">${prize.value}$</div>
            `;
            
            document.getElementById('resultModal').style.display = 'flex';
            
            addToInventory(prize);
            userBalance += prize.value;
            updateBalanceDisplay();
            saveUserData();
        }

        function closeResult() {
            document.getElementById('resultModal').style.display = 'none';
        }

        function updateCasesBalance() {
            document.getElementById('casesUserBalance').textContent = userBalance.toFixed(2);
        }

        function showDepositModal() {
            userBalance += 10000;
            updateBalanceDisplay();
            saveUserData();
        }

        function openBotForWithdraw() {
            if (userBalance < 1000) {
                return;
            }
        }

        // –ó–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
        document.addEventListener('contextmenu', event => {
            if (event.target.tagName === 'IMG') {
                event.preventDefault();
            }
        });

        document.addEventListener('selectstart', event => event.preventDefault());
        document.addEventListener('dragstart', event => {
            if (event.target.tagName === 'IMG') {
                event.preventDefault();
            }
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        document.addEventListener('click', (e) => {
            if (e.target.id === 'caseModal') {
                closeCaseModal();
            }
            if (e.target.id === 'resultModal') {
                closeResult();
            }
        });

        // –î–æ–±–∞–≤–ª—è–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
        function initializeFirstTime() {
            if (!localStorage.getItem('userBalance')) {
                userBalance = 5000;
                saveUserData();
                updateBalanceDisplay();
            }
            
            if (!localStorage.getItem('userInventory') || JSON.parse(localStorage.getItem('userInventory')).length === 0) {
                userInventory = [
                    { name: "–¢–µ—Å—Ç–æ–≤—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω", value: 500, image: "https://via.placeholder.com/100/8B5CF6/FFFFFF?text=TEST" },
                    { name: "–¢–µ—Å—Ç–æ–≤—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏", value: 200, image: "https://via.placeholder.com/100/7C3AED/FFFFFF?text=TEST" }
                ];
                saveUserData();
                updateInventoryDisplay();
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            initTelegramApp();
            initializeFirstTime();
        };
    </script>
</body>
</html>
